---
abbrlink: ''
categories:
- - OI学习笔记
- - 图论
date: '2023-06-26T11:46:20.867370+08:00'
excerpt: 前言 在学习该部分之前，请熟悉此部分的概念。比如DFS树，DFS森林，DFS序，以及其中的树边，前向边，返租边与横叉边 概念 子图的定义 假设有G\:=&lt;V,E&gt;G^{\prime}=&lt;V^{\prime},E^{\prime}&gt;两个图V^{\prime}\subseteq V且E^{\prime}\subseteq E，则我们称G'是G的子图。记作G^{\prime}\s...
tags:
- C++
- OI
- 图论
- 强连通分量
- 子图
- 缩点
- Tarjan
title: 【图论】强连通分量
updated: 2023-6-26T12:34:26.970+8:0
---
## 前言

在学习该部分之前，请熟悉此部分的概念。我们使用Tarjan算法求解时要用到的概念有：**DFS树**，**DFS森林**，**DFS序**，以及其中的`树边`，`前向边`，`返租边`与`横叉边`。了解它们有助于读者理解Tarjan的工作原理。

## 概念

### 子图的定义

假设有$G\:=<V,E>G^{\prime}=<V^{\prime},E^{\prime}>$两个图$V^{\prime}\subseteq V$且$E^{\prime}\subseteq E$，则我们称$G'$是$G$的子图。记作$G^{\prime}\subseteq G$。

### 什么是连通分量

1. 无向图中，如果在子图$G'$中所有的结点$u$与$v$之间都有`通路`，且无法再加入任何一个新的点使之满足，则我们称子图$G'$是母图的一个`连通分量`。（此时$G'$是一个极大图）
2. 有向图中，若仍然满足上述定义，则称子图$G'$是母图的一个`强连通分量`。（简称`SCC`）

## Tarjan算法

### 理论前提

因为每一个强连通分量都不可以再加入任意一个新的点，显然每一个强连通分量都是**独立**的，不存在相交的情况。而且强连通分量作为一个子图，显然也是**DFS树**中的一颗子树，自然地，我们可以通过对DFS树不断剪切SCC达到求解SCC的目的。

那么什么时候要剪去SCC呢？我们分析剪切DFS树的过程，首先我们要找到一个SCC中DFS树的顶点，这个顶点是SCC的入口，在只有树边的DFS树中，它在SCC中的入度为0，可以代表整个SCC，作为剪切的入口。

那么问题变成了如何寻找顶点。我们知道在DFS树中存在`返祖边`，同时我们知道`在环上的所有结点都是强连通分量的一部分`，因为环上的结点都可以达到环上的任意一个点。那么我们就可以断定存在返租边的结点一定不是顶点，因为它们对于上面的一个结点存在于同一个强连通分量中——这同时说明了这两点之间的所有结点都在同一个强连通分量中（构成了一个环）。

当然，这样是不够的，因为我们还存在着横叉边，这导致DFS树中的不同子树存在了联系——有可能和别的子树构成环。

试着假设情况，第一种情况就是当我们遍历到这一条横叉边时它所指向的结点已经被遍历过且没有被剪切，这说明什么？说明这个结点和指向的结点一定在一条连通的树边上。为什么呢？假设下面的情况：
